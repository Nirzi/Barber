{% extends "base.html" %}
{% block title %}Список заявок{% endblock %}

{% block content %}
<h2 class="text-center my-4">Список заявок</h2>

<!-- Поисковая форма -->
<form method="get" class="mb-4">
  <div class="row g-2 align-items-center">
    <div class="col-md-4">
      {{ form.query.label_tag }} {{ form.query }}
    </div>
    <div class="col-auto">
      {{ form.by_name }} {{ form.by_name.label_tag }}
    </div>
    <div class="col-auto">
      {{ form.by_phone }} {{ form.by_phone.label_tag }}
    </div>
    <div class="col-auto">
      {{ form.by_comment }} {{ form.by_comment.label_tag }}
    </div>
    <div class="col-auto">
      <button type="submit" class="btn btn-primary">Поиск</button>
    </div>
  </div>
</form>

<!-- Список заявок -->
{% for order in orders %}
<div class="card mb-3">
    <div class="card-body">
        <h5>{{ order.client_name }}</h5>
        <p><strong>Дата записи:</strong> {{ order.appointment_date }}</p>
        <p><strong>Статус:</strong> {{ order.get_status_display }}</p>
        <p><strong>Мастер:</strong>
            {% if order.master %}
                {{ order.master.name }}
            {% else %}
                Не назначен
            {% endif %}
        </p>
        <p><strong>Услуги:</strong>
            {% for service in order.services.all %}
                {{ service.name }}{% if not forloop.last %}, {% endif %}
            {% endfor %}
        </p>
        <a href="{% url 'order_detail' order.id %}" class="btn btn-outline-secondary btn-sm">Подробнее</a>
    </div>
</div>
{% empty %}
<p class="text-center">Заявок пока нет.</p>
{% endfor %}

<div class="text-center">
    <a href="{% url 'landing' %}" class="btn btn-secondary">На главную</a>
</div>
{% endblock %}
